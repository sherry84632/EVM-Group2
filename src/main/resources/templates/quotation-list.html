<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotation List</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/mainPageStyle.css">
    <link rel="stylesheet" href="/css/iconStyle.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
          integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
</head>
<body class="bg-gradient2-custom">
<div class="d-flex">
    <div th:replace="mainPage/navBarFragment :: navBar"></div>
    <div class="mainContent flex-grow-1 p-3" style="overflow: hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Quotations</h2>
            <a href="/quotation/new" class="btn btn-dark rounded-pill">New Quotation</a>
        </div>

        <form class="mb-3" action="/quotation/search" method="get">
            <div class="input-group" style="max-width: 420px;">
                <input name="keyword" type="text" class="form-control" placeholder="Search"
                       th:value="${keyword}">
                <button class="btn btn-outline-dark" type="submit">Search</button>
            </div>
        </form>

        <div class="table-responsive bg-white rounded shadow-sm">
            <table class="table table-hover mb-0">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Dealer</th>
                    <th>Customer</th>
                    <th>Vehicle</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Created</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="q : ${quotations}">
                    <td th:text="${q.quotationID}"></td>
                    <td th:text="${q.dealer.dealerName}"></td>
                    <td th:text="${q.customer.fullName}"></td>
                    <td>
                        <span th:text="${q.vehicle.modelName}"></span>
                        <small class="text-muted" th:text="${q.vehicle.VIN}"></small>
                    </td>
                    <td th:text="${#numbers.formatDecimal(q.totalPrice, 1, 'COMMA', 0, 'POINT')}"></td>
                    <td th:text="${q.status}"></td>
                    <td th:text="${#dates.format(q.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                    <td class="text-end">
                        <form th:action="@{'/quotation/update-status'}" method="post" class="d-inline">
                            <input type="hidden" name="quotationId" th:value="${q.quotationID}">
                            <input type="hidden" name="newStatus" value="Approved">
                            <button class="btn btn-sm btn-success">Approve</button>
                        </form>
                        <form th:action="@{'/quotation/update-status'}" method="post" class="d-inline ms-1">
                            <input type="hidden" name="quotationId" th:value="${q.quotationID}">
                            <input type="hidden" name="newStatus" value="Rejected">
                            <button class="btn btn-sm btn-outline-danger">Reject</button>
                        </form>
                        <a th:href="@{'/quotation/' + ${q.quotationID} + '/convert-to-order'}" class="btn btn-sm btn-dark ms-1">Convert to Order</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>


